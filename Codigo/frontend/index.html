<!DOCTYPE html>
<html lang="en" class="h-100" data-bs-theme="auto">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet"
        integrity="sha384-T3c6CoIi6uLrA9TneNEoa7RxnatzjcDSCmG1MXxSR1GAsXEV/Dwwykc2MPK8M2HN" crossorigin="anonymous">

    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Open+Sans:wght@300;500;600&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@docsearch/css@3">
    <link rel="stylesheet" href="/Codigo/frontend/assets/css/index.css">
    <title>PROKNOW</title>
    
    </head>
    
    <body class="text-center h-100 vh-100">
        
        <div class=" d-flex w-100 h-100 p-3 mx-auto flex-column">
            
            <header class="mb-3">
                <h3><a class="logo" href="/Codigo/frontend/pages/contenthub.html" >PROKNOW</a></h3>
                <nav class="nav nav-masthead justify-content-end">
                    <button type="button" class="btn btn-primary" data-bs-toggle="modal" data-bs-target="#ModalForm"
                    id="modal-button">Login</button>
                    </nav>
                    </header>
                    
                    
                <main class="main-content pt-auto flex-column" style="margin-top: 10px; margin-bottom: 100px;">
                    
    
                    <div id="carouselExampleCaptions" class="carousel slide">
                        <div class="carousel-indicators">
                          <button type="button" data-bs-target="#carouselExampleCaptions" data-bs-slide-to="0" class="active" aria-current="true" aria-label="Slide 1"></button>
                          <button type="button" data-bs-target="#carouselExampleCaptions" data-bs-slide-to="1" aria-label="Slide 2"></button>
                          <button type="button" data-bs-target="#carouselExampleCaptions" data-bs-slide-to="2" aria-label="Slide 3"></button>
                          <button type="button" data-bs-target="#carouselExampleCaptions" data-bs-slide-to="3" aria-label="Slide 4"></button>
                          <button type="button" data-bs-target="#carouselExampleCaptions" data-bs-slide-to="4" aria-label="Slide 5"></button>
                        </div>
                        <div class="carousel-inner">
                          <div class="carousel-item active">
                            <img src="/Codigo/frontend/assets/images/proknow_afroWoman_shocked.jpg" class="d-block w-100" alt="...">
                            <div class="custom-caption  d-none d-md-block">
                                <h101>Proknow</h101>
                                <h5>Não sabe o que procura?</h5>
                                <p>Navegue pela nossa vasta coleatânea de conteúdos:  <a style="color: rgb(153, 74, 228);"> O content hub!</a></p>
                                <p><button type="button" class="btn btn-primary"   id="modal-button"><a href="/Codigo/frontend/pages/contenthub.html"
                                         style="text-decoration: none; color: aliceblue;">Explorar</a></button></p>
                            </div>
                          </div>
                          <div class="carousel-item">
                            <img src="/Codigo/frontend/assets/images/proknow_purpleMan_mobile.jpg" class="d-block w-100" alt="...">
                            <div class="carousel-caption d-none d-md-block">
                                <h10>Proknow</h10>
                              <h5>Educação Financeira ao Seu Alcance</h5>
                              <p>Aprenda os fundamentos do mercado financeiro e como tomar decisões informadas sobre seus investimentos</p>
                              <p><button type="button" class="btn btn-primary"   id="modal-button"><a href="/Codigo/frontend/pages/newsletter.html"
                                style="text-decoration: none; color: aliceblue;">Newsletter</a></button></p>
                            </div>
                          </div>
                          <div class="carousel-item">
                            <img src="/Codigo/frontend/assets/images/proknow_asianWoman_notebook.jpg" class="d-block w-100" alt="...">
                            <div class="carousel-caption2 d-none d-md-block">
                                <h101>Proknow</h101>
                              <h5>Análise de Mercado em Tempo Real</h5>
                              <p>Fique atualizado com análises de mercado, tendências <br>e previsões para tomar decisões estratégicas.</p>
                              <p><button type="button" class="btn btn-primary"   id="modal-button"><a href="/Codigo/frontend/pages/btcTraderSpace.html"
                                style="text-decoration: none; color: aliceblue;">Trading Space</a></button></p>
                            </div>
                          </div>
                          <div class="carousel-item">
                            <img src="/Codigo/frontend/assets/images/proknow_manPurple_tablet.jpg" class="d-block w-100" alt="...">
                            <div class="custom-caption  d-none d-md-block">
                                <h10 style="font-size: small;">Proknow</h10>
                                <h5>Ainda não tem uma conta?</h5>
                                <p>Sem problemas! clique no botão abaixo e cadastre-se agora!</p>
                                <p><button type="button" class="btn btn-primary" 
                                    data-bs-toggle="modal" data-bs-target="#CadastroForm" id="modal-button"><a href="#"
                                        id="cadastro" style="text-decoration: none; color: aliceblue;">Cadastre-se</a></button></p>
                            </div>
                          </div>
                          <div class="carousel-item">
                            <img src="/Codigo/frontend/assets/images/proknnow_whiteWoman_mobile.jpg" class="d-block w-100" alt="...">
                            <div class="carousel-caption3 ">
                              <h101>Proknow</h101>
                              <h5>Aprenda com um sistema Gamificado!</h5>
                              <p>Descubra e aprenda através do nosso sistema único de <br>
                                aprendizado com desbloqueio, recompensas e badges!</p>
                              <p><button type="button" class="btn btn-primary"   id="modal-button"><a href="/Codigo/frontend/pages/journeys.html"
                                style="text-decoration: none; color: aliceblue;">Journeys</a></button></p>
                            </div>
                          </div>
                        </div>

                        <button class="carousel-control-prev" type="button" data-bs-target="#carouselExampleCaptions" data-bs-slide="prev">
                          <span class="carousel-control-prev-icon" aria-hidden="true"></span>
                          <span class="visually-hidden">Previous</span>
                        </button>
                        <button class="carousel-control-next" type="button" data-bs-target="#carouselExampleCaptions" data-bs-slide="next">
                          <span class="carousel-control-next-icon" aria-hidden="true"></span>
                          <span class="visually-hidden">Next</span>
                        </button>
                      </div>

                      

                    
        
                <!-- Modal Form -->
                <div class="modal fade" id="ModalForm" tabindex="-1" aria-hidden="true">
                <div class="modal-dialog modal-dialog-centered">
                    <div class="modal-content">
                        <!-- Login Form -->
                        <form method="post" id="login-form">
                            <div class="modal-header">
                                <h5 class="modal-title">Login</h5>
                                <button type="button" class="btn-close" data-bs-dismiss="modal"
                                    aria-label="Close"></button>
                            </div>
                            <div class="modal-body">
                                <div class="mb-3">
                                    <label for="Email">Email<span class="text-danger">*</span></label>
                                    <input type="email" name="email" class="form-control" id="emailLogin"
                                        placeholder="Insira seu Email">
                                </div>

                                <div class="mb-3">
                                    <label for="password">Senha<span class="text-danger">*</span></label>
                                    <input type="password" name="password" class="form-control" id="password"
                                        placeholder="Insira uma senha">
                                </div>
                                <div class="mb-3">
                                    <input class="form-check-input" type="checkbox" value="" id="remember" required>
                                    <label class="form-check-label" for="remember">Lembrar de mim</label>
                                </div>
                            </div>
                            <div class="modal-footer pt-4">
                                <button type="button" class="btn btn-primary mx-auto w-100" id="login-button">Login
                                </button>
                            </div>
                            <p class="text-center">Ainda não tem uma conta, <button class="btn btn-outline-warning" type="button"
                                    data-bs-toggle="modal" data-bs-target="#CadastroForm" id="modal-button"
                                        id="cadastro"> Cadastre-se</button>
                            </p>
                        </form>



                    </div>
                </div>
            </div>
            <div class="modal fade" id="CadastroForm" tabindex="-1" aria-hidden="true">
                <div class="modal-dialog modal-dialog-centered">
                    <div class="modal-content">
                        <!-- Login Form -->
                        <form method="post" id="cadastro-form">
                            <div class="modal-header">
                                <h5 class="modal-title">Criar Conta</h5>
                                <button type="button" class="btn-close" data-bs-dismiss="modal"
                                    aria-label="Close"></button>
                            </div>
                            <div class="modal-body">

                                <div class="etapa etapa1">
                                    <div class="mb-3">
                                        <label for="Usuario">Cpf <span class="text-danger">   *</span></label>
                                        <input type="text" name="usuario" class="form-control" id="cpf"
                                            placeholder="Insira seu cpf">
                                    </div>
                                    <div class="mb-3">
                                        <label for="Nome">Nome completo <span class="text-danger">   *</span></label>
                                        <input type="text" name="nome" class="form-control" id="nome"
                                            placeholder="Insira seu nome completo">
                                    </div>
                                    <div class="mb-3">
                                        <label for="Nome">Email<span class="text-danger">*</span></label>
                                        <input type="email" name="email" class="form-control" id="email"
                                            placeholder="Insira seu email">
                                    </div>

                                    <div class="mb-3">
                                        <label for="Nome">Telefone<span class="text-danger">*</span></label>
                                        <input type="phone" name="cellNumber" class="form-control" id="cellNumber"
                                            placeholder="Insira seu telefone">
                                    </div>

                                    <div class="mb-3">
                                        <label for="Senha">Senha <span class="text-danger">   *</span></label>
                                        <input type="password" name="senha" class="form-control" id="newPassword"
                                            placeholder="Insira uma senha">
                                    </div>
                                    <div class="mb-3">
                                        <label for="Senha">Confirme sua senha <span class="text-danger">   *</span></label>
                                        <input type="password" name="senha" class="form-control"
                                            id="newPasswordConfirmation" placeholder="Confirme sua senha">
                                    </div>

                                </div>

                                <div class="etapa etapa2" style="display: none;">
                                    <div class="mb-3">
                                        <label for="currency" class="form-label">Informe seu salário liquido <span
                                                class="text-danger">   *</span></label>
                                        <input type="text" class="form-control" id="currency"
                                            oninput="formatarMoeda(this)" placeholder="Insira aqui seu salário!"
                                            value="" required>
                                        <div class="invalid-feedback">
                                            Por favor, insira seu salário!
                                        </div>
                                    </div>
                                </div>
                                <div class="etapa etapa3" style="display: none;">
                                    <div class="mb-3">
                                        <label for="fixas" class="form-label">Informe suas despesas fixas <span
                                                class="text-danger">   *</span></label>
                                        <input type="text" class="form-control" id="fixas" oninput="formatarMoeda(this)"
                                            placeholder="Insira aqui suas despesas" value="" required>
                                        <div class="invalid-feedback">
                                            Por favor, insira suas despesas fixas!
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <div class="button-login">
                                <button type="button" class="btn btn-primary mb-3 mx-auto w-80"
                                    id="cadastro-button">Cadastrar
                                </button>
                                <button type="button" class="btn btn-primary mb-3 mx-auto w-80"
                                    id="avancar-button">Avançar
                                </button>
                            </div>
                    </div>
                    </form>
                </div>
            </div>
            

    

    </main>

    <footer class="footer mt-auto py-3">
        <p><a id="footer-link"
                href="https://github.com/ICEI-PUC-Minas-PMGCC-TI/ti-1-pmg-cc-m-20232-g10-falta-de-educacao-financeira"
                >&copy; 2024 PROKNOW.</a> Todos os direitos reservados.</p>
    </footer>
    
    </div>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"
        integrity="sha384-C6RzsynM9kWDrMNeT87bh95OGNyZPhcTNXj1NW7RuBCsyN/o0jlpcV8Qyq46cDfL"
        crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
    <script src="./assets/js/login.js"></script>
 
    <script>

        const cadastroButton = document.getElementById('cadastro-button');
        const avancarButton = document.getElementById('avancar-button');

        const cpf = document.getElementById("cpf").value.trim();
        const name = document.getElementById("nome").value.trim();
        const email = document.getElementById("email").value.trim();
        const password = document.getElementById("newPassword").value.trim();
        const passwordConfirmation = document.getElementById("newPasswordConfirmation").value.trim();

        const salario = document.getElementById('currency').value; // Valor do campo "salario"
        const campoAdicional = document.getElementById('campoAdicional');



        let etapaAtual = 1;

        async function processaFormLogin(event) {

            event.preventDefault();

            // Captura dos valores dos campos de texto
            let username = document.getElementById("emailLogin").value.trim();
            let password = document.getElementById("password").value.trim();

            // Verifica se ambos os campos estão preenchidos
            if (username.length === 0 || password.length === 0) {
                alert('Por favor, preencha ambos os campos de usuário e senha.');
                return;
            }

            let user = await login(username, password);

            if (user) {
                console.log("finalmente caralho", user); // olha a lingua
            } else {
                alert('Usuário ou senha incorretos');
            }
        }
           


        document.addEventListener('DOMContentLoaded', function () {

            cadastroButton.style.display = 'none';
            avancarButton.style.display = 'block';

            console.log('etapa:', etapaAtual);


            function avancaEtapa() {

                const etapaAtualElement = document.querySelector(`.etapa${etapaAtual}`);
                etapaAtualElement.style.display = 'none';

                etapaAtual++;

                if (etapaAtual < 3) {
                    cadastroButton.style.display = 'none';
                    avancarButton.style.display = 'block';
                } else {
                    cadastroButton.style.display = 'block';
                    avancarButton.style.display = 'none';
                }

                console.log('etapa pos ++', etapaAtual);
                if (etapaAtual > 3) {

                    $('#CadastroForm').modal('hide');
                    return;
                }

                const proximaEtapaElement = document.querySelector(`.etapa${etapaAtual}`);
                proximaEtapaElement.style.display = 'block';

            }
            avancarButton.addEventListener('click', avancaEtapa);
        });

        function createUser(cpf, password, name, email, cellNumber, salario, fixas) {

            let user = {
                "cpf": cpf,
                "password": password,
                "name": name,
                "email": email,
                "cellNumber": cellNumber,
                "salary": salario,
                "expenses": fixas
            }


            return user;
        }

        async function postUser() {

            const cpf = document.getElementById("cpf").value.trim();
            const name = document.getElementById("nome").value.trim();
            const email = document.getElementById("email").value.trim();
            const cellNumber = document.getElementById("cellNumber").value.trim();
            const password = document.getElementById("newPassword").value.trim();
            const passwordConfirmation = document.getElementById("newPasswordConfirmation").value.trim();

            const salario = document.getElementById('currency').value.trim();

            const fixas = document.getElementById('fixas').value;
        
            let user = createUser(cpf, password, name, email, cellNumber, salario, fixas);
            console.log(user);

            if (cpf.length === 0 || password.length === 0 || passwordConfirmation.length === 0 || nome.length === 0 || email.length === 0) {
                alert('Por favor, preencha todos os campos.');
                return;
            }

            if (password !== passwordConfirmation) {
                alert('As senhas não coincidem.');
                return;
            }

            try {
                const response = await fetch("http://localhost:4567/usuarios", {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify(user)
                });

                const respBody = await response.json();

                console.log(respBody.data);

                if (respBody.data) {
                    alert('Usuário cadastrado com sucesso!');
                    $('#CadastroForm').modal('hide');
                    sessionStorage.setItem('usuario', JSON.stringify(respBody.data));
                    window.location = './frontend/pages/dashboard.html';
                }

            } catch (error) {
                console.error('Erro ao cadastrar usuário: ', error);
                alert('Ocorreu um erro ao processar a requisição.');
            }
        }


        document.getElementById("cadastro-button").addEventListener("click", postUser);

        document.getElementById("login-button").addEventListener("click", processaFormLogin);


    </script>

<script>
    const hasInvestments = document.getElementById('ativos');

    hasInvestments.addEventListener('change', function () {
        if (hasInvestments.value == 'Sim') {
            campoAdicional.style.display = 'block';
        } else {
            campoAdicional.style.display = 'none';
        }
    })

    const currency = document.querySelector("#currency");

    const formatter = new Intl.NumberFormat('pt-BR', {
        style: 'currency',
        currency: 'BRL',
        minimumFractionDigits: 2,
    });

    function formatarMoeda(input) {
        let valor = input.value.replace(/\D/g, '');

        input.value = formatter.format(valor / 100);
    }
</script>

</body>

</html>