<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.5.3/dist/css/bootstrap.min.css">
    <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:400,500,700&display=swap">
    <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,600,700&display=swap">
    <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Nunito:400&display=swap">

    <title>Journeys</title>

    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet"
        integrity="sha384-T3c6CoIi6uLrA9TneNEoa7RxnatzjcDSCmG1MXxSR1GAsXEV/Dwwykc2MPK8M2HN" crossorigin="anonymous">
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"
        integrity="sha384-C6RzsynM9kWDrMNeT87bh95OGNyZPhcTNXj1NW7RuBCsyN/o0jlpcV8Qyq46cDfL"
        crossorigin="anonymous"></script>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@docsearch/css@3">
    <link rel="stylesheet" href="../assets/css/sidenav.css">
    <link rel="stylesheet" href="../assets/css/badges.css">
</head>

<style>
    .banner {
        position: relative;
        height: 40vw;
        width: 100vw;
        overflow: hidden;

    }

    .banner img {
        width: 100%;
        height: 100%;
        object-fit: cover;
        opacity: 0.5;
    }

    .banner-text {
        position: absolute;
        top: 50%;
        left: 50%;
        transform: translate(-50%, -50%);
        color: white;
        font-size: 2em;
        text-align: center;
        text-shadow: -1px 0 black, 0 0.2px black, 0.2px 0 black, 0 -1px black;
    }
</style>

<body class="d-flex">

    <aside>
        <div id="sidebar" class="sidebar d-flex flex-column flex-shrink-0 h-100 " onmouseover="toggleSidebar()"
            onmouseout="toggleSidebar()">
            <ul class="nav nav-pills nav-flush flex-column mb-auto text-center ">
                <li id="inicio" class="selected">
                    <a href="./dashboard.html" class="nav-link py-3 rounded-0" aria-current="page"
                        data-bs-toggle="tooltip" data-bs-placement="right"><i
                            class="material-icons fa-solid fa-home fa-xl mx-2"></i><span class="txt">Inicio</span></a>
                </li>
                <li id="content-hub">
                    <a href="./contenthub.html" class="nav-link " aria-current="page" data-bs-toggle="tooltip"
                        data-bs-placement="right"><i class="material-icons fa-solid fa-book-open fa-xl mx-2"></i><span
                            class="txt">Content
                            Hub</span></a>
                </li>
                <li id="trader-space">
                    <a href="./btcTraderSpace.html" class="nav-link py-3 rounded-0" aria-current="page"
                        data-bs-toggle="tooltip" data-bs-placement="right"><i
                            class="material-icons fa-solid fa-chart-line fa-xl mx-2"></i><span class="txt">Trader
                            Space</span></a>
                </li>
                <li id="newsletter">
                    <a href="./newsletter.html" class="nav-link py-3 rounded-0" aria-current="page"
                        data-bs-toggle="tooltip" data-bs-placement="right"><i
                            class="material-icons fa-regular fa-newspaper fa-xl mx-2"></i><span
                            class="txt">Newsletter</span></a>
                </li>
                <li id="journeys">
                    <a href="./journeys.html" class="nav-link py-3  rounded-0" aria-current="page"
                        data-bs-toggle="tooltip" data-bs-placement="right"><i
                            class="material-icons fa-regular fa-compass fa-xl mx-2"></i><span
                            class="txt">Journeys</span></a>
                </li>
            </ul>
            <div class="dropdown"><a href="#"
                    class="d-flex align-items-center justify-content-center p-3 link-body-emphasis text-decoration-none dropdown-toggle"
                    data-bs-toggle="dropdown" aria-expanded="false">
                    <div class="thumbnail-profile">
                        <img src="../assets/images/avatar.png">
                    </div>
                </a>
                <ul class="dropdown-menu text-small">
                    <li><a href="#" class="dropdown-item text-dark">Perfil</a></li>
                    <li><a href="#" class="dropdown-item text-dark">Configuracoes</a></li>
                    <li>
                        <hr class="dropdown-divider" style="color: lightgray;">
                    </li>
                    <li><a href="../index.html" class="dropdown-item text-dark" onclick="logout()">Sair</a></li>
                </ul>
            </div>
        </div>

    </aside>

    <main>
        <div class="banner">
            <img src="../assets/images/journey.jpg" alt="">
            <div class="banner-text">
                <h1>O que sao as Journeys?</h1>
                <p>Pensando em tornar a jornada em busca de seu desenvolvimento mais imersiva e satisfatória,
                    gostariamos de lhes apresentar as Journeys. Acreditamos que reconhecimento faz parte do processo, e
                    por isso, estimulamos que assuma novos desafios, conquiste novas badges e torne-se uma das grandes
                    referencias dentro do nosso ambiente.</p>
            </div>
        </div>
        <div class="container mt-5">
            <div class="row">
                <!-- Chame a função createCard para criar os cards desejados -->
                <script>
                function getBadges(processaDados) {
    fetch("http://localhost:4567/badges")
        .then(response => {
            if (!response.ok) {
                throw new Error('Network response was not ok ' + response.statusText);
            }
            return response.json();
        })
        .then(data => {
            processaDados(data.data); // Exibe os badges no console, ou faça outro tipo de manipulação
        })
        .catch(error => {
            console.error('Erro ao ler badges:', error);
            displayMessage("Erro ao ler badges");
        });
}

function getUserBadges(userId) {
    return fetch(`http://localhost:4567/usuarios-badges/${userId}`)
        .then(response => {
            if (!response.ok) {
                throw new Error('Network response was not ok ' + response.statusText);
            }
            return response.json();
        })
        .then(data => {
            return data.data.map(entry => entry.badge_id); // Extrai apenas os badge_ids da resposta
        })
        .catch(error => {
            console.error('Erro ao verificar badges do usuário:', error);
            return [];
        });
}

const userId = "21c58399-6300-4f31-8476-f5b49939b7ba"; // Supondo que o ID do usuário seja conhecido e fixo para este exemplo

getUserBadges(userId).then(userBadges => {
    getBadges(badges => {
        console.log(badges);
        createBadgeCard(badges, userBadges);
    });
});

function createBadgeCard(badges, userBadges) {
    badges.forEach(badge => {
        const exists = userBadges.includes(badge.id);
        
        const cardContainer = document.createElement('div');
        cardContainer.classList.add('card-container', 'col-md-4', 'mb-4', 'my-2');

        const cardInner = document.createElement('div');
        cardInner.classList.add('card-inner');

        const cardFront = document.createElement('div');
        cardFront.classList.add('card-front', 'card');

        if (exists) {
            cardFront.classList.add('enabled'); // Adiciona a classe apenas se badge está habilitado
        }

        const cardBack = document.createElement('div');
        cardBack.classList.add('card-back', 'card', 'p-3');

        let icon = document.createElement('img');
        icon.src = badge.linkImage; // A URL do ícone
        console.log(icon.src);
        icon.alt = "Badge Icon";
        icon.classList.add('icon');
        const title = document.createElement('h5');
        title.textContent = badge.name;
        title.classList.add('card-title');

        cardFront.appendChild(icon);
        cardFront.appendChild(title);
        // Adiciona descrição no verso do card
        const requirements = document.createElement('b');
        requirements.textContent = 'Requisitos:';
        requirements.classList.add('card-text', 'align-self-start', 'mb-2');

        cardBack.appendChild(requirements);

        const description = document.createElement('p');
        description.textContent = badge.description;
        description.classList.add('card-text');

        cardBack.appendChild(description);

        cardInner.appendChild(cardFront);
        cardInner.appendChild(cardBack);
        cardContainer.appendChild(cardInner);

        document.querySelector('.container .row').appendChild(cardContainer);
    });
}

                </script>
            </div>
        </div>
        <footer class="footer mt-auto py-3">
            <p><a id="footer-link"
                    href="https://github.com/ICEI-PUC-Minas-PMGCC-TI/ti-1-pmg-cc-m-20232-g10-falta-de-educacao-financeira">&copy;
                    2024 PROKNOW.</a> Todos os direitos reservados.</p>
        </footer>
    </main>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/js/bootstrap.bundle.min.js"
        integrity="sha384-kenU1KFdBIe4zVF0s0G1M5b4hcpxyD9F7jL+jjXkk+Q2h455rYXK/7HAuoJl+0I4"
        crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.11.6/dist/umd/popper.min.js"
        integrity="sha384-oBqDVmMz9ATKxIep9tiCxS/Z9fNfEXiDAYTujMAeBAsjFuCZSmKbSSUnQlmh/jp3"
        crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/js/bootstrap.min.js"
        integrity="sha384-cuYeSxntonz0PPNlHhBs68uyIAVpIIOZZ5JqeqvYYIcEL727kskC66kF92t6Xl2V"
        crossorigin="anonymous"></script>
    <script src="../../assets/js/sidebar-loader.js"></script>
    <script src="https://kit.fontawesome.com/113fc1b747.js" crossorigin="anonymous"></script>
    <script src="../assets/js/login.js"></script>

</body>

</html>